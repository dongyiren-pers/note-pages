<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>第5章 输入输出管理 | 后端技术栈笔记</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script src="/note-pages//s0.pstatp.com/cdn/expire-1-M/jquery/3.4.0/jquery.min.js"></script>
    <script src="/note-pages//s0.pstatp.com/cdn/expire-1-M/fancybox/3.5.7/jquery.fancybox.min.js"></script>
    <link rel="stylesheet" href="/note-pages//s0.pstatp.com/cdn/expire-1-M/fancybox/3.5.7/jquery.fancybox.min.css">
    <meta name="description" content="BackEnd Notes">
    
    <link rel="preload" href="/note-pages/assets/css/0.styles.167a34c7.css" as="style"><link rel="preload" href="/note-pages/assets/js/app.05dcbd87.js" as="script"><link rel="preload" href="/note-pages/assets/js/3.4a2f67fd.js" as="script"><link rel="preload" href="/note-pages/assets/js/2.ab82720e.js" as="script"><link rel="preload" href="/note-pages/assets/js/16.818fc8bf.js" as="script"><link rel="prefetch" href="/note-pages/assets/js/10.e11a80d9.js"><link rel="prefetch" href="/note-pages/assets/js/100.489cf69a.js"><link rel="prefetch" href="/note-pages/assets/js/101.560e37ea.js"><link rel="prefetch" href="/note-pages/assets/js/102.baaa4f6a.js"><link rel="prefetch" href="/note-pages/assets/js/103.262b6423.js"><link rel="prefetch" href="/note-pages/assets/js/104.ac33d7ce.js"><link rel="prefetch" href="/note-pages/assets/js/105.5e6ce18f.js"><link rel="prefetch" href="/note-pages/assets/js/106.a69322ef.js"><link rel="prefetch" href="/note-pages/assets/js/107.6cdb78ee.js"><link rel="prefetch" href="/note-pages/assets/js/108.1d720289.js"><link rel="prefetch" href="/note-pages/assets/js/109.58f7297c.js"><link rel="prefetch" href="/note-pages/assets/js/11.241a46da.js"><link rel="prefetch" href="/note-pages/assets/js/110.9cef761d.js"><link rel="prefetch" href="/note-pages/assets/js/111.c782138c.js"><link rel="prefetch" href="/note-pages/assets/js/112.40cb3b1a.js"><link rel="prefetch" href="/note-pages/assets/js/113.c367e40a.js"><link rel="prefetch" href="/note-pages/assets/js/114.a4a75db5.js"><link rel="prefetch" href="/note-pages/assets/js/115.a73cd469.js"><link rel="prefetch" href="/note-pages/assets/js/116.ad853155.js"><link rel="prefetch" href="/note-pages/assets/js/117.a82b2649.js"><link rel="prefetch" href="/note-pages/assets/js/118.8f896dd0.js"><link rel="prefetch" href="/note-pages/assets/js/119.374482b1.js"><link rel="prefetch" href="/note-pages/assets/js/12.ebe220d5.js"><link rel="prefetch" href="/note-pages/assets/js/120.89698284.js"><link rel="prefetch" href="/note-pages/assets/js/121.cbe50685.js"><link rel="prefetch" href="/note-pages/assets/js/122.7de2ac51.js"><link rel="prefetch" href="/note-pages/assets/js/123.a2d16009.js"><link rel="prefetch" href="/note-pages/assets/js/124.e1ba7cbe.js"><link rel="prefetch" href="/note-pages/assets/js/125.4e1e6d6a.js"><link rel="prefetch" href="/note-pages/assets/js/126.3db22af3.js"><link rel="prefetch" href="/note-pages/assets/js/127.937f4ffc.js"><link rel="prefetch" href="/note-pages/assets/js/128.0bad2e20.js"><link rel="prefetch" href="/note-pages/assets/js/129.75a99d25.js"><link rel="prefetch" href="/note-pages/assets/js/13.5ee7bef5.js"><link rel="prefetch" href="/note-pages/assets/js/130.599b6d3d.js"><link rel="prefetch" href="/note-pages/assets/js/131.687214bf.js"><link rel="prefetch" href="/note-pages/assets/js/132.8295c067.js"><link rel="prefetch" href="/note-pages/assets/js/133.854d61c0.js"><link rel="prefetch" href="/note-pages/assets/js/134.f3fc20e1.js"><link rel="prefetch" href="/note-pages/assets/js/135.2a5a690d.js"><link rel="prefetch" href="/note-pages/assets/js/136.6ba30378.js"><link rel="prefetch" href="/note-pages/assets/js/137.80d7c511.js"><link rel="prefetch" href="/note-pages/assets/js/138.0a25898e.js"><link rel="prefetch" href="/note-pages/assets/js/139.fb3c377f.js"><link rel="prefetch" href="/note-pages/assets/js/14.a561f8b3.js"><link rel="prefetch" href="/note-pages/assets/js/140.cbfdbe32.js"><link rel="prefetch" href="/note-pages/assets/js/141.c09f054f.js"><link rel="prefetch" href="/note-pages/assets/js/142.723bd973.js"><link rel="prefetch" href="/note-pages/assets/js/143.b31785f9.js"><link rel="prefetch" href="/note-pages/assets/js/144.69d3d121.js"><link rel="prefetch" href="/note-pages/assets/js/145.c4ee6aa0.js"><link rel="prefetch" href="/note-pages/assets/js/146.7f836a1c.js"><link rel="prefetch" href="/note-pages/assets/js/147.d4a57976.js"><link rel="prefetch" href="/note-pages/assets/js/148.b15e75eb.js"><link rel="prefetch" href="/note-pages/assets/js/149.94085ddc.js"><link rel="prefetch" href="/note-pages/assets/js/15.4ed118f1.js"><link rel="prefetch" href="/note-pages/assets/js/150.6751d41b.js"><link rel="prefetch" href="/note-pages/assets/js/151.bd60e322.js"><link rel="prefetch" href="/note-pages/assets/js/152.15caf78f.js"><link rel="prefetch" href="/note-pages/assets/js/153.131128fc.js"><link rel="prefetch" href="/note-pages/assets/js/154.b8ee2e7d.js"><link rel="prefetch" href="/note-pages/assets/js/155.8fa1e2e0.js"><link rel="prefetch" href="/note-pages/assets/js/156.25e2a796.js"><link rel="prefetch" href="/note-pages/assets/js/157.7137c9c3.js"><link rel="prefetch" href="/note-pages/assets/js/158.fdc18c40.js"><link rel="prefetch" href="/note-pages/assets/js/159.0dadb745.js"><link rel="prefetch" href="/note-pages/assets/js/160.05f7541c.js"><link rel="prefetch" href="/note-pages/assets/js/161.2a8c62a2.js"><link rel="prefetch" href="/note-pages/assets/js/162.5b9983b7.js"><link rel="prefetch" href="/note-pages/assets/js/163.b51a5538.js"><link rel="prefetch" href="/note-pages/assets/js/164.06c9f20a.js"><link rel="prefetch" href="/note-pages/assets/js/165.c25063f4.js"><link rel="prefetch" href="/note-pages/assets/js/166.6c570da5.js"><link rel="prefetch" href="/note-pages/assets/js/167.12fb6fb6.js"><link rel="prefetch" href="/note-pages/assets/js/168.d7dd27bc.js"><link rel="prefetch" href="/note-pages/assets/js/169.27f575fe.js"><link rel="prefetch" href="/note-pages/assets/js/17.9daf0c47.js"><link rel="prefetch" href="/note-pages/assets/js/170.ba4295ef.js"><link rel="prefetch" href="/note-pages/assets/js/171.3fb54078.js"><link rel="prefetch" href="/note-pages/assets/js/18.086ed162.js"><link rel="prefetch" href="/note-pages/assets/js/19.adca670c.js"><link rel="prefetch" href="/note-pages/assets/js/20.2e9ff004.js"><link rel="prefetch" href="/note-pages/assets/js/21.07830947.js"><link rel="prefetch" href="/note-pages/assets/js/22.609929cb.js"><link rel="prefetch" href="/note-pages/assets/js/23.d83b832f.js"><link rel="prefetch" href="/note-pages/assets/js/24.592e8014.js"><link rel="prefetch" href="/note-pages/assets/js/25.9d28bb6f.js"><link rel="prefetch" href="/note-pages/assets/js/26.fd4195d5.js"><link rel="prefetch" href="/note-pages/assets/js/27.ca60e875.js"><link rel="prefetch" href="/note-pages/assets/js/28.c2cd75e6.js"><link rel="prefetch" href="/note-pages/assets/js/29.4213d132.js"><link rel="prefetch" href="/note-pages/assets/js/30.c6ee0ead.js"><link rel="prefetch" href="/note-pages/assets/js/31.eea6a542.js"><link rel="prefetch" href="/note-pages/assets/js/32.1ffdceaf.js"><link rel="prefetch" href="/note-pages/assets/js/33.0425748b.js"><link rel="prefetch" href="/note-pages/assets/js/34.5dd0d81d.js"><link rel="prefetch" href="/note-pages/assets/js/35.773df14e.js"><link rel="prefetch" href="/note-pages/assets/js/36.5db32ea2.js"><link rel="prefetch" href="/note-pages/assets/js/37.1106162c.js"><link rel="prefetch" href="/note-pages/assets/js/38.793ba7d0.js"><link rel="prefetch" href="/note-pages/assets/js/39.488fb9a5.js"><link rel="prefetch" href="/note-pages/assets/js/4.550e6883.js"><link rel="prefetch" href="/note-pages/assets/js/40.9c05b0ae.js"><link rel="prefetch" href="/note-pages/assets/js/41.ae198526.js"><link rel="prefetch" href="/note-pages/assets/js/42.d815456e.js"><link rel="prefetch" href="/note-pages/assets/js/43.1808aff8.js"><link rel="prefetch" href="/note-pages/assets/js/44.c26d9bde.js"><link rel="prefetch" href="/note-pages/assets/js/45.fae5f755.js"><link rel="prefetch" href="/note-pages/assets/js/46.703057c9.js"><link rel="prefetch" href="/note-pages/assets/js/47.ed3a23ce.js"><link rel="prefetch" href="/note-pages/assets/js/48.c5a46ee8.js"><link rel="prefetch" href="/note-pages/assets/js/49.b04c1681.js"><link rel="prefetch" href="/note-pages/assets/js/5.869d288f.js"><link rel="prefetch" href="/note-pages/assets/js/50.249fc2a7.js"><link rel="prefetch" href="/note-pages/assets/js/51.cab74632.js"><link rel="prefetch" href="/note-pages/assets/js/52.e2f231b3.js"><link rel="prefetch" href="/note-pages/assets/js/53.6241e308.js"><link rel="prefetch" href="/note-pages/assets/js/54.7d29c5c0.js"><link rel="prefetch" href="/note-pages/assets/js/55.a9050f95.js"><link rel="prefetch" href="/note-pages/assets/js/56.75828a09.js"><link rel="prefetch" href="/note-pages/assets/js/57.b3f75d67.js"><link rel="prefetch" href="/note-pages/assets/js/58.0cf3bd1c.js"><link rel="prefetch" href="/note-pages/assets/js/59.19f18f1f.js"><link rel="prefetch" href="/note-pages/assets/js/6.d879438f.js"><link rel="prefetch" href="/note-pages/assets/js/60.61940d92.js"><link rel="prefetch" href="/note-pages/assets/js/61.bc890bb0.js"><link rel="prefetch" href="/note-pages/assets/js/62.f487437c.js"><link rel="prefetch" href="/note-pages/assets/js/63.4a91369b.js"><link rel="prefetch" href="/note-pages/assets/js/64.1b0770e4.js"><link rel="prefetch" href="/note-pages/assets/js/65.b56e2b22.js"><link rel="prefetch" href="/note-pages/assets/js/66.dd49594c.js"><link rel="prefetch" href="/note-pages/assets/js/67.22efede4.js"><link rel="prefetch" href="/note-pages/assets/js/68.0d22a8a4.js"><link rel="prefetch" href="/note-pages/assets/js/69.aec9bfeb.js"><link rel="prefetch" href="/note-pages/assets/js/7.e3626849.js"><link rel="prefetch" href="/note-pages/assets/js/70.0c53c20d.js"><link rel="prefetch" href="/note-pages/assets/js/71.6d6db7d6.js"><link rel="prefetch" href="/note-pages/assets/js/72.fdcfb985.js"><link rel="prefetch" href="/note-pages/assets/js/73.a390b48d.js"><link rel="prefetch" href="/note-pages/assets/js/74.e817987f.js"><link rel="prefetch" href="/note-pages/assets/js/75.f144cf4f.js"><link rel="prefetch" href="/note-pages/assets/js/76.7be2f5f1.js"><link rel="prefetch" href="/note-pages/assets/js/77.6568d596.js"><link rel="prefetch" href="/note-pages/assets/js/78.4ff63ca8.js"><link rel="prefetch" href="/note-pages/assets/js/79.daaf791e.js"><link rel="prefetch" href="/note-pages/assets/js/8.f9f716a1.js"><link rel="prefetch" href="/note-pages/assets/js/80.a0605696.js"><link rel="prefetch" href="/note-pages/assets/js/81.ecb125f5.js"><link rel="prefetch" href="/note-pages/assets/js/82.b64b1c42.js"><link rel="prefetch" href="/note-pages/assets/js/83.d13b7f19.js"><link rel="prefetch" href="/note-pages/assets/js/84.c584da75.js"><link rel="prefetch" href="/note-pages/assets/js/85.7992353f.js"><link rel="prefetch" href="/note-pages/assets/js/86.17ad6399.js"><link rel="prefetch" href="/note-pages/assets/js/87.289f9f2f.js"><link rel="prefetch" href="/note-pages/assets/js/88.3496d6e2.js"><link rel="prefetch" href="/note-pages/assets/js/89.0d0c778d.js"><link rel="prefetch" href="/note-pages/assets/js/9.3209071f.js"><link rel="prefetch" href="/note-pages/assets/js/90.245b9fda.js"><link rel="prefetch" href="/note-pages/assets/js/91.806af5f2.js"><link rel="prefetch" href="/note-pages/assets/js/92.8a10f401.js"><link rel="prefetch" href="/note-pages/assets/js/93.ea90ae18.js"><link rel="prefetch" href="/note-pages/assets/js/94.98cc66ef.js"><link rel="prefetch" href="/note-pages/assets/js/95.836e96c5.js"><link rel="prefetch" href="/note-pages/assets/js/96.d4dd3eee.js"><link rel="prefetch" href="/note-pages/assets/js/97.e4275cb9.js"><link rel="prefetch" href="/note-pages/assets/js/98.0e320d92.js"><link rel="prefetch" href="/note-pages/assets/js/99.e6f77650.js">
    <link rel="stylesheet" href="/note-pages/assets/css/0.styles.167a34c7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/note-pages/" class="home-link router-link-active"><!----> <span class="site-name">后端技术栈笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/note-pages/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础知识" class="dropdown-title"><span class="title">基础知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="基础知识" class="mobile-dropdown-title"><span class="title">基础知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          算法
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/algorithm/5e022a/" class="nav-link">
  算法
</a></li></ul></li><li class="dropdown-item"><h4>
          计算机网络
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/network/a918ca/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-subitem"><a href="/note-pages/http/" class="nav-link">
  HTTP
</a></li><li class="dropdown-subitem"><a href="/note-pages/tcp-ip/" class="nav-link">
  TCP/IP
</a></li><li class="dropdown-subitem"><a href="/note-pages/socket/" class="nav-link">
  Socket
</a></li></ul></li><li class="dropdown-item"><h4>
          操作系统
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/operating-system/knuk3x/" class="nav-link">
  操作系统
</a></li><li class="dropdown-subitem"><a href="/note-pages/linux/" class="nav-link">
  Linux
</a></li></ul></li><li class="dropdown-item"><h4>
          其他
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/database-system/fyl5c1/" class="nav-link">
  数据库系统
</a></li><li class="dropdown-subitem"><a href="/note-pages/computer-systems/" class="nav-link">
  计算机系统
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title">编程语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程语言" class="mobile-dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Java
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/java/5ddf72/" class="nav-link">
  Java基础
</a></li><li class="dropdown-subitem"><a href="/note-pages/java-collection/" class="nav-link">
  Java集合
</a></li><li class="dropdown-subitem"><a href="/note-pages/java-concurrency/" class="nav-link">
  Java并发
</a></li><li class="dropdown-subitem"><a href="/note-pages/jvm/" class="nav-link">
  JVM
</a></li></ul></li><li class="dropdown-item"><h4>
          C/C++
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/cpp/" class="nav-link">
  C++基础
</a></li></ul></li><li class="dropdown-item"><h4>
          Go
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/go/" class="nav-link">
  Go基础
</a></li></ul></li><li class="dropdown-item"><h4>
          其他
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/assembly/" class="nav-link">
  Assembly
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发框架" class="dropdown-title"><span class="title">开发框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="开发框架" class="mobile-dropdown-title"><span class="title">开发框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/spring/" class="nav-link">
  Spring
</a></li></ul></li><li class="dropdown-item"><h4>
          数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/mysql/1dh29a/" class="nav-link">
  MySQL
</a></li><li class="dropdown-subitem"><a href="/note-pages/redis/" class="nav-link">
  Redis
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="架构设计" class="dropdown-title"><span class="title">架构设计</span> <span class="arrow down"></span></button> <button type="button" aria-label="架构设计" class="mobile-dropdown-title"><span class="title">架构设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          分布式
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/distributed-system/01-理论基础/" class="nav-link">
  分布式系统
</a></li></ul></li><li class="dropdown-item"><h4>
          微服务
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/micro-service-in-action/" class="nav-link">
  微服务实战
</a></li></ul></li><li class="dropdown-item"><h4>
          消息队列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/kafka/" class="nav-link">
  Kafka
</a></li><li class="dropdown-subitem"><a href="/note-pages/rocket-mq/" class="nav-link">
  RocketMQ
</a></li></ul></li><li class="dropdown-item"><h4>
          注册中心
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/zookeeper/" class="nav-link">
  ZooKeeper
</a></li><li class="dropdown-subitem"><a href="/note-pages/eureka/" class="nav-link">
  Eureka
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发工具" class="dropdown-title"><span class="title">开发工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="开发工具" class="mobile-dropdown-title"><span class="title">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note-pages/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/note-pages/docker/34kd5q/" class="nav-link">
  Docker
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="理论方法" class="dropdown-title"><span class="title">理论方法</span> <span class="arrow down"></span></button> <button type="button" aria-label="理论方法" class="mobile-dropdown-title"><span class="title">理论方法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note-pages/design-pattern/" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/note-pages/software-engineering/n4r1lx/" class="nav-link">
  软件工程
</a></li></ul></div></div><div class="nav-item"><a href="/note-pages/interview/f05h67/" class="nav-link">
  面试通关
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/note-pages/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础知识" class="dropdown-title"><span class="title">基础知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="基础知识" class="mobile-dropdown-title"><span class="title">基础知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          算法
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/algorithm/5e022a/" class="nav-link">
  算法
</a></li></ul></li><li class="dropdown-item"><h4>
          计算机网络
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/network/a918ca/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-subitem"><a href="/note-pages/http/" class="nav-link">
  HTTP
</a></li><li class="dropdown-subitem"><a href="/note-pages/tcp-ip/" class="nav-link">
  TCP/IP
</a></li><li class="dropdown-subitem"><a href="/note-pages/socket/" class="nav-link">
  Socket
</a></li></ul></li><li class="dropdown-item"><h4>
          操作系统
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/operating-system/knuk3x/" class="nav-link">
  操作系统
</a></li><li class="dropdown-subitem"><a href="/note-pages/linux/" class="nav-link">
  Linux
</a></li></ul></li><li class="dropdown-item"><h4>
          其他
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/database-system/fyl5c1/" class="nav-link">
  数据库系统
</a></li><li class="dropdown-subitem"><a href="/note-pages/computer-systems/" class="nav-link">
  计算机系统
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title">编程语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程语言" class="mobile-dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Java
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/java/5ddf72/" class="nav-link">
  Java基础
</a></li><li class="dropdown-subitem"><a href="/note-pages/java-collection/" class="nav-link">
  Java集合
</a></li><li class="dropdown-subitem"><a href="/note-pages/java-concurrency/" class="nav-link">
  Java并发
</a></li><li class="dropdown-subitem"><a href="/note-pages/jvm/" class="nav-link">
  JVM
</a></li></ul></li><li class="dropdown-item"><h4>
          C/C++
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/cpp/" class="nav-link">
  C++基础
</a></li></ul></li><li class="dropdown-item"><h4>
          Go
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/go/" class="nav-link">
  Go基础
</a></li></ul></li><li class="dropdown-item"><h4>
          其他
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/assembly/" class="nav-link">
  Assembly
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发框架" class="dropdown-title"><span class="title">开发框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="开发框架" class="mobile-dropdown-title"><span class="title">开发框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/spring/" class="nav-link">
  Spring
</a></li></ul></li><li class="dropdown-item"><h4>
          数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/mysql/1dh29a/" class="nav-link">
  MySQL
</a></li><li class="dropdown-subitem"><a href="/note-pages/redis/" class="nav-link">
  Redis
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="架构设计" class="dropdown-title"><span class="title">架构设计</span> <span class="arrow down"></span></button> <button type="button" aria-label="架构设计" class="mobile-dropdown-title"><span class="title">架构设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          分布式
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/distributed-system/01-理论基础/" class="nav-link">
  分布式系统
</a></li></ul></li><li class="dropdown-item"><h4>
          微服务
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/micro-service-in-action/" class="nav-link">
  微服务实战
</a></li></ul></li><li class="dropdown-item"><h4>
          消息队列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/kafka/" class="nav-link">
  Kafka
</a></li><li class="dropdown-subitem"><a href="/note-pages/rocket-mq/" class="nav-link">
  RocketMQ
</a></li></ul></li><li class="dropdown-item"><h4>
          注册中心
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note-pages/zookeeper/" class="nav-link">
  ZooKeeper
</a></li><li class="dropdown-subitem"><a href="/note-pages/eureka/" class="nav-link">
  Eureka
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发工具" class="dropdown-title"><span class="title">开发工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="开发工具" class="mobile-dropdown-title"><span class="title">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note-pages/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/note-pages/docker/34kd5q/" class="nav-link">
  Docker
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="理论方法" class="dropdown-title"><span class="title">理论方法</span> <span class="arrow down"></span></button> <button type="button" aria-label="理论方法" class="mobile-dropdown-title"><span class="title">理论方法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note-pages/design-pattern/" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/note-pages/software-engineering/n4r1lx/" class="nav-link">
  软件工程
</a></li></ul></div></div><div class="nav-item"><a href="/note-pages/interview/f05h67/" class="nav-link">
  面试通关
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/note-pages/operating-system/knuk3x/" class="sidebar-link">第1章 操作系统概述</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note-pages/operating-system/knuk3x/#_1-1-操作系统的基本概念" class="sidebar-link">1.1 操作系统的基本概念</a></li><li class="sidebar-sub-header"><a href="/note-pages/operating-system/knuk3x/#_1-2-操作系统的发展与分类" class="sidebar-link">1.2 操作系统的发展与分类</a></li><li class="sidebar-sub-header"><a href="/note-pages/operating-system/knuk3x/#_1-3-操作系统的运行机制与体系结构" class="sidebar-link">1.3 操作系统的运行机制与体系结构</a></li></ul></li><li><a href="/note-pages/operating-system/9xtgs8/" class="sidebar-link">第2章 进程与线程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note-pages/operating-system/9xtgs8/#_2-1-进程与线程" class="sidebar-link">2.1 进程与线程</a></li><li class="sidebar-sub-header"><a href="/note-pages/operating-system/9xtgs8/#_2-2-处理机的调度" class="sidebar-link">2.2 处理机的调度</a></li><li class="sidebar-sub-header"><a href="/note-pages/operating-system/9xtgs8/#_2-3-进程的同步与互斥" class="sidebar-link">2.3 进程的同步与互斥</a></li><li class="sidebar-sub-header"><a href="/note-pages/operating-system/9xtgs8/#_2-4-死锁" class="sidebar-link">2.4 死锁</a></li></ul></li><li><a href="/note-pages/operating-system/owchkr/" class="sidebar-link">第3章 内存管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note-pages/operating-system/owchkr/#_3-1-内存管理相关概念" class="sidebar-link">3.1 内存管理相关概念</a></li><li class="sidebar-sub-header"><a href="/note-pages/operating-system/owchkr/#_3-2-虚拟内存" class="sidebar-link">3.2 虚拟内存</a></li></ul></li><li><a href="/note-pages/operating-system/vfjnsa/" class="sidebar-link">第4章 文件管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note-pages/operating-system/vfjnsa/#_4-1-文件系统" class="sidebar-link">4.1 文件系统</a></li><li class="sidebar-sub-header"><a href="/note-pages/operating-system/vfjnsa/#_4-2-磁盘管理" class="sidebar-link">4.2 磁盘管理</a></li></ul></li><li><a href="/note-pages/operating-system/05-输入输出管理.html" class="active sidebar-link">第5章 输入输出管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note-pages/operating-system/05-输入输出管理.html#_5-1-i-o-管理概述" class="sidebar-link">5.1 I/O 管理概述</a></li><li class="sidebar-sub-header"><a href="/note-pages/operating-system/05-输入输出管理.html#_5-2-i-o-核心子系统" class="sidebar-link">5.2 I/O 核心子系统</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="第5章-输入输出管理"><a href="#第5章-输入输出管理" class="header-anchor">#</a> 第5章 输入输出管理</h1> <h2 id="_5-1-i-o-管理概述"><a href="#_5-1-i-o-管理概述" class="header-anchor">#</a> 5.1 I/O 管理概述</h2> <h3 id="i-o-设备及其分类"><a href="#i-o-设备及其分类" class="header-anchor">#</a> I/O 设备及其分类</h3> <p>I/O 设备管理是操作系统设计中最凌乱也最具挑战性的部分。由于它包含了很多领域的不同设备以及与设备相关的应用程序，因此很难有一个通用且一致的设计方案。所以在理解设备管理之前，应该先了解具体的 I/O 设备类型。</p> <p>计算机系统中的 I/O 设备按使用特性可分为以下类型：</p> <ul><li>人机交互类外部设备：用于同计算机用户之间交互的设备，如打印机、显示器、鼠标、键盘等。这类设备数据交换速度相对较慢，通常是以字节为单位进行数据交换。</li> <li>存储设备：用于存储程序和数据的设备，如磁盘、磁带、光盘等。这类设备用于数据交换，速度较快，通常以多字节组成的块为单位进行数据交换。</li> <li>网络通信设备：用于与远程设备通信的设备，如各种网络接口、调制解调器等。其速度介于前两类设备之间。网络通信设备在使用和管理上与前两类设备也有很大不同。</li></ul> <p>除了上面最常见的分类方法，I/O设备还可以按以下方法分类：</p> <p><strong>按传输速率分类</strong>：</p> <ul><li>低速设备：传输速率仅为每秒几个到数百个字节的一类设备，如键盘、鼠标等。</li> <li>中速设备：传输速率在每秒数千个字节至数万个字节的一类设备，如行式打印机、 激光打印机等。</li> <li>高速设备：传输速率在数百个千字节至千兆字节的一类设备，如磁带机、磁盘机、 光盘机等。</li></ul> <p><strong>按信息交换的单位分类</strong>：</p> <ul><li><strong>块设备</strong>：由于信息的存取总是以数据块为单位，所以存储信息的设备称为块设备。它属于有结构设备，如磁盘等。磁盘设备的基本特征是传输速率较高，以及可寻址，即对它可随机地读/写任一块。</li> <li><strong>字符设备</strong>：用于数据输入/输出的设备为字符设备，因为其传输的基本单位是字符。它属于无结构类型，如交互式终端机、打印机等。它们的基本特征是传输速率低、不可寻址，并且在输入/输出时常釆用中断驱动方式。</li></ul> <h3 id="i-o-控制方式"><a href="#i-o-控制方式" class="header-anchor">#</a> I/O 控制方式</h3> <p>设备管理的主要任务之一是 <strong>控制设备和内存或处理机之间的数据传送</strong>，外围设备和内存之间的输入/输出控制方式有四种，下面分别介绍。</p> <div id="程序直接控制方式" class="anchor">程序直接控制方式</div><p>如图（a）所示，计算机从外部设备读取数据到存储器，每次读一个字的数据。对读入的每个字，CPU 需要对外设状态进行循环检查，直到确定该字已经在 I/O 控制器的数据寄存器中。在程序直接控制方式中，<strong>由于 CPU 的高速性和 I/O 设备的低速性，致使 CPU 的绝大部分时间都处于等待 I/O 设备完成数据 I/O 的循环测试中，造成了 CPU 资源的极大浪费</strong>。在该方式中，CPU 之所以要不断地测试 I/O 设备的状态，就是因为在 CPU 中没有釆用中断机构，使 I/O 设备无法向 CPU 报告它已完成了一个字符的输入操作。</p> <p>程序直接控制方式虽然简单易于实现，但是其缺点也是显而易见的，由于 CPU 和 I/O 设备只能串行工作，导致 CPU 的利用率相当低。</p> <div id="中断驱动方式" class="anchor">中断驱动方式</div><p>中断驱动方式的思想是，<strong>允许 I/O 设备主动打断 CPU 的运行并请求服务</strong>，从而 “解放” CPU，使得其向 I/O 控制器发送读命令后可以继续做其他有用的工作。如图（b）所示，我们从 I/O 控制器和 CPU 两个角度分别来看中断驱动方式的工作过程：从 I/O 控制器的角度来看，I/O 控制器从 CPU 接收一个读命令，然后从外围设备读数据。一旦数据读入到该 I/O 控制器的 <strong>数据寄存器</strong>，便通过控制线给 CPU 发出一个中断信号，表示数据已准备好，然后等待 CPU 请求该数据。I/O 控制器收到 CPU 发出的取数据请求后，将数据放到数据总线上，传到 CPU 的寄存器中。至此，本次 I/O 操作完成，I/O 控制器又可幵始下一次 I/O 操作。</p> <p><img src="/note-pages/assets/img/727485-20210705152952934-762826735.2257c840.png" alt="img"></p> <p>从 CPU 的角度来看，CPU 发出读命令，然后保存当前运行程序的上下文（现场，包括程序计数器及处理机寄存器），转去执行其他程序。在每个指令周期的末尾，CPU 检查中断。当有来自 I/O 控制器的中断时，CPU 保存当前正在运行程序的上下文，转去执行中断处理程序处理该中断。这时，CPU 从 I/O 控制器读一个字的数据传送到寄存器，并存入主存。接着，CPU 恢复发出 I/O 命令的程序（或其他程序）的上下文，然后继续运行。</p> <p>中断驱动方式比程序直接控制方式有效，但由于数据中的每个字在存储器与 I/O 控制器之间的传输都必须经过 CPU，这就导致了中断驱动方式仍然会消耗较多的 CPU 时间。</p> <div id="dma-方式（直接内存存取）" class="anchor">DMA 方式（直接内存存取）</div><p>在中断驱动方式中，I/O 设备与内存之间的数据交换必须要经过 CPU 中的寄存器，所以速度还是受限，而 DMA（直接存储器存取）方式的基本思想是 <strong>在 I/O 设备和内存之间开辟直接的数据交换通路</strong>，彻底 “解放” CPU。DMA 方式的特点是：</p> <ul><li>基本单位是数据块。</li> <li>所传送的数据，是从设备直接送入内存的，或者相反。</li> <li>仅在传送一个或多个数据块的开始和结束时，才需 CPU 干预，整块数据的传送是在 DMA 控制器的控制下完成的。</li></ul> <p><img src="/note-pages/assets/img/727485-20210705153043212-1310246782.0787c64f.png" alt="img"></p> <p>为了实现在主机与控制器之间成块数据的直接交换，必须在 DMA 控制器中设置如下四类寄存器：</p> <ul><li>命令/状态寄存器（CR）：用于接收从 CPU 发来的 I/O 命令或有关控制信息，或设备的状态。</li> <li>内存地址寄存器（MAR）：在输入时，它存放把数据从设备传送到内存的起始目标地址；在输出时，它存放由内存到设备的内存源地址。</li> <li>数据寄存器（DR）：用于暂存从设备到内存，或从内存到设备的数据。</li> <li>数据计数器（DC）：存放本次 CPU 要读或写的字（节）数。</li></ul> <p>如图（c）所示，<strong>DMA 方式的工作过程是</strong>：CPU 读写数据时，它给 I/O 控制器发出一条命令，启动 DMA 控制器，然后继续其他工作。之后 CPU 就把控制操作委托给 DMA 控制器，由该控制器负责处理。DMA 控制器直接与存储器交互，传送整个数据块，每次传送一个字，这个过程不需要 CPU 参与。当传送完成后，DMA 控制器发送一个中断信号给处理器。因此只有在传送开始和结束时才需要 CPU 的参与。</p> <p>DMA 控制方式与中断驱动方式的主要区别是中断驱动方式在每个数据需要传输时中断 CPU，而 DMA 控制方式则是在所要求传送的一批数据全部传送结束时才中断 CPU；此外，中断驱动方式数据传送是在中断处理时由 CPU 控制完成的，而 DMA 控制方式则是在 DMA 控制器的控制下完成的。</p> <div id="通道控制方式" class="anchor">通道控制方式</div><p>I/O 通道是指专门负责输入/输出的处理机。I/O 通道方式是 DMA 方式的发展，它可以进一步减少 CPU 的干预，即把对一个数据块的读（或写）为单位的干预，减少为对 <strong>一组数据块</strong> 的读（或写）及有关的控制和管理为单位的干预。同时，又可以实现 CPU、通道和 I/O 设备三者的并行操作，从而更有效地提高整个系统的资源利用率。</p> <p>例如，当 CPU 要完成一组相关的读（或写）操作及有关控制时，只需向 I/O 通道发送一条 I/O 指令，以给出其所要执行的通道程序的首地址和要访问的 I/O 设备，通道接到该指令后，通过执行通道程序便可完成 CPU 指定的 I/O 任务，数据传送结束时向 CPU 发中断请求。</p> <p>I/O 通道与一般处理机的区别是：通道指令的类型单一，没有自己的内存，通道所执行的通道程序是放在主机的内存中的，也就是说通道与 CPU 共享内存。</p> <p>I/O 通道与 DMA 方式的区别是：DMA 方式需要 CPU 来控制传输的数据块大小、传输的内存位置，而通道方式中这些信息是由通道控制的。另外，每个 DMA 控制器对应一台设备与内存传递数据，而一个通道可以控制多台设备与内存的数据交换。</p> <h2 id="_5-2-i-o-核心子系统"><a href="#_5-2-i-o-核心子系统" class="header-anchor">#</a> 5.2 I/O 核心子系统</h2> <h3 id="i-o-子系统的层次结构"><a href="#i-o-子系统的层次结构" class="header-anchor">#</a> I/O 子系统的层次结构</h3> <p>I/O 软件涉及的面非常广，往下与硬件有着密切的联系，往上又与用户直接交互，它与进程管理、存储器管理、文件管理等都存在着一定的联系，即它们都可能需要 I/O 软件来实现 I/O 操作。</p> <p>为了使复杂的 I/O 软件具有清晰的结构，良好的可移植性和适应性，在 I/O 软件中普遍釆用了层次式结构，将系统输入/输出功能组织成一系列的层次，每一层都利用其下层提供的服务，完成输入/输出功能中的某些子功能，并屏蔽这些功能实现的细节，向高层提供服务。</p> <p>在层次式结构的 I/O 软件中，只要层次间的接口不变，对某一层次中的软件的修改都不会引起其下层或高层代码的变更，仅最底层才涉及硬件的具体特性。</p> <p><img src="data:image/png;base64,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" alt="img"></p> <p>一个比较合理的层次划分如图所示。整个 I/O 系统可以看成具有四个层次的系统结构，各层次及其功能如下：</p> <div id="用户层-i-o-软件" class="anchor">用户层 I/O 软件</div><p>用户层 I/O 软件：实现与用户交互的接口，用户可直接调用在用户层提供的、与 I/O 操作有关的库函数，对设备进行操作。</p> <p>一般而言，大部分的 I/O 软件都在操作系统内部，但仍有一小部分在用户层，包括与用户程序链接在一起的库函数，以及完全运行于内核之外的一些程序。用户层软件必须通过一组系统调用来获取操作系统服务。</p> <div id="设备独立性软件" class="anchor">设备独立性软件</div><p>设备独立性软件：用于实现用户程序与设备驱动器的统一接口、设备命令、设备保护、以友设备分配与释放等，同时为设备管理和数据传送提供必要的存储空间。</p> <p>设备独立性也称 <strong>设备无关性</strong>，使得应用程序独立于具体使用的物理设备。为了实现设备独立性而引入了逻辑设备和物理设备这两个概念。在应用程序中，<strong>使用逻辑设备名来请求使用某类设备</strong>；而在系统实际执行时，必须将逻辑设备名映射成物理设备名使用。</p> <p>使用逻辑设备名的好处是：</p> <ul><li>增加设备分配的灵活性；</li> <li>易于实现 I/O 重定向，所谓 I/O 重定向，是指用于 I/O 操作的设备可以更换（即重定向），而不必改变应用程序。</li></ul> <p>为了实现设备独立性，必须再在驱动程序之上设置一层设备独立性软件。总的来说，设备独立性软件的主要功能可分以为以下两个方面：</p> <ul><li>执行所有设备的公有操作。包括：对设备的分配与回收；将逻辑设备名映射为物理设备名；对设备进行保护，禁止用户直接访问设备；缓冲管理；差错控制；提供独立于设备的大小统一的逻辑块，屏蔽设备之间信息交换单位大小和传输速率的差异。</li> <li>向用户层（或文件层）提供统一接口。无论何种设备，它们向用户所提供的接口应该是相同的。例如，对各种设备的读/写操作，在应用程序中都统一使用 read/write 命令等。</li></ul> <div id="设备驱动程序" class="anchor">设备驱动程序</div><p>设备驱动程序：与硬件直接相关，负责具体实现系统对设备发出的操作指令，驱动 I/O设备工作的驱动程序。</p> <p>通常，每一类设备配置一个设备驱动程序，它是 I/O 进程与设备控制器之间的通信程序，常以进程形式存在。设备驱动程序向上层用户程序提供一组标准接口，设备具体的差别被设备驱动程序所封装，用于接收上层软件发来的抽象 I/O 要求，如 read 和 write 命令，转换为具体要求后，发送给设备控制器，控制 I/O 设备工作；它也将由设备控制器发来的信号传送给上层软件。从而为 I/O 内核子系统隐藏设备控制器之间的差异。</p> <div id="中断处理程序" class="anchor">中断处理程序</div><p>中断处理程序：用于保存被中断进程的 CPU 环境，转入相应的中断处理程序进行处理，处理完并恢复被中断进程的现场后，返回到被中断进程。</p> <p>中断处理层的主要任务有：进行进程上下文的切换，对处理中断信号源进行测试，读取设备状态和修改进程状态等。由于中断处理与硬件紧密相关，对用户而言，应尽量加以屏蔽，故应放在操作系统的底层，系统的其余部分尽可能少地与之发生联系。</p> <div id="硬件设备" class="anchor">硬件设备</div><p>硬件设备：I/O 设备通常包括一个机械部件和一个电子部件。为了达到设计的模块性和通用性，一般将其分开：电子部件称为设备控制器（或适配器），在个人计算机中，通常是一块插入主板扩充槽的印刷电路板；机械部件则是设备本身。</p> <p>设备控制器通过寄存器与 CPU 通信，在某些计算机上，这些寄存器占用内存地址的一部分，称为内存映像 I/O；另一些计算机则釆用 I/O 专用地址，寄存器独立编址。操作系统通过向控制器寄存器写命令字来执行 I/O 功能。控制器收到一条命令后，CPU 可以转向进行其他工作，而让设备控制器自行完成具体的 I/O 操作。当命令执行完毕后，控制器发出一个中断信号，操作系统重新获得 CPU 的控制权并检查执行结果，此时，CPU 仍旧是从控制器寄存器中读取信息来获得执行结果和设备的状态信息。</p> <p>设备控制器的主要功能为：</p> <ul><li>接收和识别CPU或通道发来的命令，如磁盘控制器能接收读、写、查找等命令。</li> <li>实现数据交换，包括设备和控制器之间的数据传输；通过数据总线或通道，控制器和主存之间的数据传输。</li> <li>发现和记录设备及自身的状态信息，供CPU处理使用。</li> <li>设备地址识别。</li></ul> <p>为实现上述功能，设备控制器（如图）必须包含以下组成部分：</p> <ul><li>设备控制器与 CPU 的接口。该接口有三类信号线：数据线、地址线和控制线。数据线通常与两类寄存器相连接：数据寄存器（存放从设备送来的输入数据或从 CPU 送来的输出数据）和控制/状态寄存器（存放从 CPU 送来的控制信息或设备的状态信息）。</li> <li>设备控制器与设备的接口。设备控制器连接设备需要相应数量的接口，一个接口连接一台设备。每个接口中都存在数据、控制和状态三种类型的信号。</li> <li>I/O 控制逻辑。用于实现对设备的控制。它通过一组控制线与 CPU 交互，对从 CPU 收到的 I/O 命令进行译码。CPU 启动设备时，将启动命令发送给控制器，同时通过地：址线把地址发送给控制器，由控制器的 I/O 逻辑对地址进行译码，并相应地对所选设备进行控制。</li></ul> <p><img src="/note-pages/assets/img/727485-20210705153132305-697540828.ce1dbeee.png" alt="img"></p> <h3 id="i-o-子系统概述和-i-o-调度的概念"><a href="#i-o-子系统概述和-i-o-调度的概念" class="header-anchor">#</a> I/O 子系统概述和 I/O 调度的概念</h3> <div id="i-o-子系统概述" class="anchor">I/O 子系统概述</div><p>由于 I/O 设备种类繁多，功能和传输速率差异巨大，需要多种方法来进行设备控制。这些方法共同组成了操作系统内核的 I/O 子系统，它将内核的其他方面从繁重的 I/O 设备管理中解放出来。I/O 核心子系统提供的服务主要有 I/O 调度、缓冲与高速缓存、设备分配与回收、假脱机、设备保护和差错处理等。</p> <div id="i-o-调度概念" class="anchor">I/O 调度概念</div><p>I/O 调度就是 <strong>确定一个好的顺序来执行这些 I/O 请求</strong>。应用程序所发布的系统调用的顺序不一定总是最佳选择，所以需要 I/O 调度来改善系统整体性能，使进程之间公平地共享设备访问，减少 I/O 完成所需要的平均等待时间。</p> <p>操作系统开发人员通过为每个设备维护一个请求队列来实现调度。当一个应用程序执行阻塞 I/O 系统调用时，该请求就加到相应设备的队列上。I/O 调度会重新安排队列顺序以改善系统总体效率和应用程序的平均响应时间。</p> <p>I/O子系统还可以使用主存或磁盘上的存储空间的技术，如缓冲、高速缓冲、假脱机等，来改善计算机效率。</p> <h3 id="高速缓存与缓冲区"><a href="#高速缓存与缓冲区" class="header-anchor">#</a> 高速缓存与缓冲区</h3> <div id="磁盘高速缓存" class="anchor">磁盘高速缓存</div><p>操作系统中使用磁盘高速缓存技术来提高磁盘的 I/O 速度，对高速缓存复制的访问要比原始数据访问更为高效。例如，正在运行的进程的指令既存储在磁盘上，也存储在物理内存上，也被复制到 CPU 的二级和一级高速缓存中。</p> <p>不过，磁盘高速缓存技术不同于通常意义下的介于 CPU 与内存之间的小容量高速存储器，而是 <strong>指利用内存中的存储空间来暂存从磁盘中读出的一系列盘块中的信息</strong>。因此，<strong>磁盘高速缓存在逻辑上属于磁盘，物理上则是驻留在内存中的盘块。</strong></p> <p>高速缓存在内存中分为两种形式：一种是在内存中开辟一个单独的存储空间作为磁速缓存，大小固定；另一种是把未利用的内存空间作为一个缓沖池，供请求分页系统和磁盘 I/O 时共享。</p> <div id="缓冲区" class="anchor">缓冲区</div><p>在设备管理子系统中，引入缓冲区的目的主要有：</p> <ul><li>缓和 CPU 与 I/O 设备间速度不匹配的矛盾。</li> <li>减少对 CPU 的中断频率，放宽对 CPU 中断响应时间的限制。</li> <li>解决基本数据单元大小（即数据粒度）不匹配的问题。</li> <li>提高 CPU 和 I/O 设备之间的并行性。</li></ul> <p>其实现方法有：</p> <ul><li>釆用硬件缓冲器，但由于成本太高，除一些关键部位外，一般不釆用硬件缓冲器。</li> <li>釆用缓冲区（位于内存区域）。</li></ul> <p>根据系统设置缓冲器的个数，缓冲技术可以分为：</p> <ul><li>单缓冲：在设备和处理机之间设置一个缓冲区。设备和处理机交换数据时，先把被交换数据写入缓冲区，然后需要数据的设备或处理机从缓冲区取走数据。系统对每一块数据的处理时间为 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>C</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">)</mo><mo>+</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">\max(C,T)+M</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span></span>。</li></ul> <p><img src="/note-pages/assets/img/727485-20210705153600517-825432426.a2cbd01d.png" alt="img"></p> <ul><li>双缓冲：根据单缓冲的特点，CPU在传送时间M内处于空闲状态，由此引入双缓冲。I/O 设备输入数据时先装填到缓冲区 1，在缓冲区 1 填满后才开始装填缓冲区 2，与此同时处理机可以从缓冲区 1 中取出数据放入用户进程处理，当缓冲区 1 中的数据处理完后，若缓冲区 2 已填满，则处理机又从缓冲区 2 中取出数据放入用户进程处理，而 I/O 设备又可以装填缓冲区 1。双缓冲机制提高了处理机和输入设备的并行操作的程度。</li></ul> <p><img src="/note-pages/assets/img/727485-20210705153616976-1737327009.d65d89d9.png" alt="img"></p> <ul><li>循环缓冲：包含多个大小相等的缓冲区，每个缓冲区中有一个链接指针指向下一个缓冲区，最后一个缓冲区指针指向第一个缓冲区，多个缓冲区构成一个环形。循环缓冲用于输入/输出时，还需要有两个指针 in 和 out。对输入而言，首先要从设备接收数据到缓冲区中，in 指针指向可以输入数据的第一个空缓冲区；当运行进程需要数据时，从循环缓冲区中取一个装满数据的缓冲区，并从此缓冲区中提取数据，out 指针指向可以提取数据的第一个满缓冲区。输出则正好相反。</li> <li>缓冲池：由多个系统公用的缓冲区组成，缓冲区按其使用状况可以形成三个队列：<strong>空缓冲队列</strong>、装满输入数据的缓冲队列（<strong>输入队列</strong>）和装满输出数据的缓沖队列（<strong>输出队列</strong>）。还应具有四种缓冲区：用于 <strong>收容输入数据</strong> 的工作缓冲区、用于 <strong>提取输入数据</strong> 的工作缓冲区、 用于 <strong>收容输出数据</strong> 的工作缓冲区及用于 <strong>提取输出数据</strong> 的工作缓冲区，如图所示。当输入进程需要输入数据时，便从空缓冲队列的队首摘下一个空缓冲区，把它作为收容输入工作缓冲区，然后把输入数据输入其中，装满后再将它挂到输入队列队尾。当计算进程需要输入数据时，便从输入队列取得一个缓冲区作为提取输入工作缓冲区，计算进程从中提取数据，数据用完后再将它挂到空缓冲队列尾。当计算进程需要输出数据时，便从空缓冲队列的队首取得一个空缓冲区，作为收容输出工作缓冲区，当其中装满输出数据后，再将它挂到输出队列队尾。当要输出时，由输出进程从输出队列中取得一个装满输出数据的缓冲区，作为提取输出工作缓冲区，当数据提取完后，再将它挂到空缓冲队列的队尾。</li></ul> <p><img src="/note-pages/assets/img/727485-20210705153810732-1401722473.86fcfe41.png" alt="img"></p> <h3 id="输入-输出设备分配与回收"><a href="#输入-输出设备分配与回收" class="header-anchor">#</a> 输入/输出设备分配与回收</h3> <div id="设备分配概述" class="anchor">设备分配概述</div><p>设备分配是指根据用户的 I/O 请求分配所需的设备。分配的总原则是充分发挥设备的使用效率，尽可能地让设备忙碌，又要避免由于不合理的分配方法造成进程死锁。从设备的特性来看，釆用下述三种使用方式的设备分别称为独占设备、共享设备和虚拟设备三类。</p> <ul><li><strong>独占式使用设备</strong>。指在申请设备时，如果设备空闲，就将其独占，不再允许其他进程申请使用，一直等到该设备被释放才允许其他进程申请使用。例如，打印机，在使用它打印时，只能独占式使用，否则在同一张纸上交替打印不同任务的内容，无法正常阅读。</li> <li><strong>分时式共享使用设备</strong>。独占式使用设备时，设备利用率很低，当设备没有独占使用的要求时，可以通过分时共享使用，提高利用率。例如，对磁盘设备的 I/O 操作，各进程的每次 I/O 操作请求可以通过分时来交替进行。</li> <li><strong>以 SPOOLing 方式使用外部设备</strong>。SPOOLing 技术是在批处理操作系统时代引入的，即假脱机 I/O 技术。这种技术用于对设备的操作，实质上就是对 I/O 操作进行批处理。</li></ul> <div id="设备分配的数据结构" class="anchor">设备分配的数据结构</div><p>设备分配依据的主要数据结构有设备控制表（DCT）、控制器控制表（COCT）、通道控制表（CHCT）和系统设备表（SDT），各数据结构功能如下：</p> <ul><li>设备控制表 DCT：系统为每一个设备配置一张 DCT，如图所示。它用于 <strong>记录设备的特性以及与 I/O 控制器连接的情况</strong>。DCT 包括设备标识符、设备类型、设备状态、指向控制器控制表 COCT 的指针等。其中，设备状态指示设备是忙还是空闲，设备队列指针指向等待使用该设备的进程组成的等待队列，控制表指针指向与该设备相连接的设备控制器。</li></ul> <p><img src="/note-pages/assets/img/727485-20210705153851710-1565939924.73fa7730.png" alt="img"></p> <ul><li><p>控制器控制表 COCT：每个控制器都配有一张 COCT，如图（a）所示。它反映 <strong>设备控制器的使用状态</strong> 以及 <strong>通道的连接情况</strong> 等。</p></li> <li><p>通道控制表 CHCT：每个通道配有一张 CHCT，如图（b）所示。</p></li> <li><p>系统设备表 SDT：整个系统只有一张 SDT，如图（c）所示。它记录 <strong>已连接到系统中的所有物理设备的情况</strong>，每个物理设备占一个表目。</p></li></ul> <p><img src="/note-pages/assets/img/727485-20210705153902036-1775113797.4105bb78.png" alt="img"></p> <p>由于在多道程序系统中，进程数多于资源数，会引起资源的竞争。因此，要有一套合理的分配原则，主要考虑的因素有：I/O 设备的固有属性、I/O 设备的分配算法、设备分配的安全性以及设备独立性。</p> <div id="设备分配的策略" class="anchor">设备分配的策略</div><p><strong>设备分配原则</strong>：设备分配应根据设备特性、用户要求和系统配置情况。分配的总原则既要充分发挥设备的使用效率，又要避免造成进程死锁，还要将用户程序和具体设备隔离开。</p> <p><strong>设备分配方式</strong>：设备分配方式有静态分配和动态分配两种。</p> <ul><li>静态分配主要用于对独占设备的分配，它在用户作业开始执行前，由系统一次性分配该作业所要求的全部设备、控制器（和通道)。一旦分配后，这些设备、控制器（和通道）就一直为该作业所占用，直到该作业被撤销。静态分配方式不会出现死锁，但设备的使用效率低。因此，静态分配方式弁不符合分配的总原则。</li> <li>动态分配是在进程执行过程中根据执行需要进行。当进程需要设备时，通过系统调用命令向系统提出设备请求，由系统按照事先规定的策略给进程分配所需要的设备、I/O控制器，一旦用完之后，便立即释放。动态分配方式有利于提高设备的利用率，但如果分配算法使用不当，则有可能造成进程死锁。</li></ul> <p><strong>设备分配算法</strong>：常用的动态设备分配算法有 <strong>先请求先分配</strong>、<strong>优先级高者优先</strong> 等。</p> <p>对于独占设备，既可以釆用动态分配方式也可以静态分配方式，往往釆用静态分配方式，即在作业执行前，将作业所要用的这一类设备分配给它。共享设备可被多个进程所共享，一般釆用动态分配方式，但在每个 I/O 传输的单位时间内只被一个进程所占有，通常釆用先请求先分配和优先级高者先分的分配算法。</p> <div id="设备分配的安全性" class="anchor">设备分配的安全性</div><p>设备分配的安全性是指设备分配中应 <strong>防止发生进程死锁</strong>。</p> <ul><li>安全分配方式：每当进程发出 I/O 请求后便进入阻塞状态，直到其 I/O 操作完成时才被唤醒。这样，一旦进程已经获得某种设备后便阻塞，不能再请求任何资源，而且在它阻塞时也不保持任何资源。优点是设备分配安全；缺点是 CPU 和 I/O 设备是串行工作的（对同一进程而言）。</li> <li>不安全分配方式：进程在发出 I/O 请求后继续运行，需要时又发出第二个、第三个 I/O 请求等。仅当进程所请求的设备已被另一进程占用时，才进入阻塞状态。优点是一个进程可同时操作多个设备，从而使进程推进迅速；缺点是这种设备分配有可能产生死锁。</li></ul> <div id="逻辑设备名到物理设备名的映射" class="anchor">逻辑设备名到物理设备名的映射</div><p>为了提高设备分配的灵活性和设备的利用率、方便实现 I/O 重定向，因此引入了设备独立性。设备独立性是指应用程序独立于具体使用的物理设备。</p> <p>为了实现设备独立性，在应用程序中使用逻辑设备名来请求使用某类设备，在系统中设置一张 <strong>逻辑设备表（Logical Unit Table，LUT）</strong>，用于将逻辑设备名映射为物理设备名。LUT 表项包括逻辑设备名、物理设备名和设备驱动程序入口地址；当进程用逻辑设备名来请求分配设备时，系统为它分配相应的物理设备，并在 LUT 中建立一个表项，以后进程再利用逻辑设备名请求 I/O 操作时，系统通过查找 LUT 来寻找相应的物理设备和驱动程序。</p> <p>在系统中可釆取两种方式建立逻辑设备表：</p> <ul><li>在整个系统中只设置一张 LUT。这样，所有进程的设备分配情况都记录在这张表中，故不允许有相同的逻辑设备名，主要适用于单用户系统中。</li> <li>为每个用户设置一张 LUT。当用户登录时，系统便为该用户建立一个进程，同时也为之建立一张 LUT，并将该表放入进程的 PCB 中。</li></ul> <h3 id="spooling-技术-假脱机技术"><a href="#spooling-技术-假脱机技术" class="header-anchor">#</a> SPOOLing 技术（假脱机技术）</h3> <p>为了缓和 CPU 的高速性与 I/O 设备低速性之间的矛盾而引入了脱机输入/输出技术。该技术是利用专门的外围控制机，将低速 I/O 设备上的数据传送到高速磁盘上；或者相反。SPOOLing 的意思是外部设备同时联机操作，又称为假脱机输入/输出操作，是操作系统中釆用的一项将独占设备改造成共享设备的技术。</p> <p>SPOOLing系统组成如图所示。</p> <div id="输入井和输出井" class="anchor">输入井和输出井</div><p>在磁盘上开辟出的两个存储区域。输入井模拟脱机输入时的磁盘，用于收容 I/O 设备输入的数据。输出井模拟脱机输出时的磁盘，用于收容用户程序的输出数据。</p> <p><img src="/note-pages/assets/img/727485-20210705153952974-1711145553.75bcc53f.png" alt="img"></p> <div id="输入缓冲区和输出缓冲区" class="anchor">输入缓冲区和输出缓冲区</div><p>在内存中开辟的两个缓冲区。输入缓冲区用于暂存由输入设备送来的数据，以后再传送到输入井。输出缓冲区用于暂存从输出井送来的数据，以后再传送到输出设备。</p> <div id="输入进程和输出进程" class="anchor">输入进程和输出进程</div><p>输入进程模拟脱机输入时的外围控制机，将用户要求的数据从输入机通过输入缓冲区再送到输入井。当 CPU 需要输入数据时，直接将数据从输入井读入内存。输出进程模拟脱机 输出时的外围控制机，把用户要求输出的数据先从内存送到输出并，待输出设备空闲时，再 将输出井中的数据经过输出缓冲区送到输出设备。</p> <p>共享打印机是使用 SPOOLing 技术的一个实例，这项技术已被广泛地用于多用户系统和局域网络中。当用户进程请求打印输出时，SPOOLing 系统同意为它打印输出，但并不真正立即把打印机分配给该用户进程，而只为它做两件事：</p> <ul><li>由输出进程在输出井中为之申请一个空闲磁盘块区，并将要打印的数据送入其中。</li> <li>输出进程再为用户进程申请一张空白的用户请求打印表，并将用户的打印要求填入其中，再将该表挂到请求打印队列上。</li></ul> <p>SPOOLing 系统的主要特点有：提高了 I/O 的速度；将独占设备改造为共享设备；实现了虚拟设备功能。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/note-pages/operating-system/vfjnsa/" class="prev">
        第4章 文件管理
      </a></span> <!----></p></div> </main> <aside items="[object Object],[object Object],[object Object],[object Object],[object Object]" class="right-sidebar"><div style="margin-left:20px; margin-bottom: 10px; text-align: center; font-size:16px;font-weight:bold;">此页内容</div> <div class="right-sidebar-wrap"><ul class="right-sidebar-links"><li id="tab-item0" class="right-sidebar-item active"><a href="#_5-1-i-o-管理概述" class="right-sidebar-item-level2">
          5.1 I/O 管理概述
        </a></li><li id="tab-item1" class="right-sidebar-item"><a href="#i-o-设备及其分类" class="right-sidebar-item-level3">
          I/O 设备及其分类
        </a></li><li id="tab-item2" class="right-sidebar-item"><a href="#i-o-控制方式" class="right-sidebar-item-level3">
          I/O 控制方式
        </a></li><li id="tab-item3" class="right-sidebar-item"><a href="#_5-2-i-o-核心子系统" class="right-sidebar-item-level2">
          5.2 I/O 核心子系统
        </a></li><li id="tab-item4" class="right-sidebar-item"><a href="#i-o-子系统的层次结构" class="right-sidebar-item-level3">
          I/O 子系统的层次结构
        </a></li><li id="tab-item5" class="right-sidebar-item"><a href="#i-o-子系统概述和-i-o-调度的概念" class="right-sidebar-item-level3">
          I/O 子系统概述和 I/O 调度的概念
        </a></li><li id="tab-item6" class="right-sidebar-item"><a href="#高速缓存与缓冲区" class="right-sidebar-item-level3">
          高速缓存与缓冲区
        </a></li><li id="tab-item7" class="right-sidebar-item"><a href="#输入-输出设备分配与回收" class="right-sidebar-item-level3">
          输入/输出设备分配与回收
        </a></li><li id="tab-item8" class="right-sidebar-item"><a href="#spooling-技术-假脱机技术" class="right-sidebar-item-level3">
          SPOOLing 技术（假脱机技术）
        </a></li></ul></div></aside></div><div class="global-ui"></div></div>
    <script src="/note-pages/assets/js/app.05dcbd87.js" defer></script><script src="/note-pages/assets/js/3.4a2f67fd.js" defer></script><script src="/note-pages/assets/js/2.ab82720e.js" defer></script><script src="/note-pages/assets/js/16.818fc8bf.js" defer></script>
  </body>
</html>
