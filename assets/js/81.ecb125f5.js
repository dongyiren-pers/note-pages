(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{1056:function(s,a,t){"use strict";t.r(a);var e=t(14),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"第1章-类字节码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#第1章-类字节码"}},[s._v("#")]),s._v(" 第1章 类字节码")]),s._v(" "),e("h2",{attrs:{id:"_1-1-字节码文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-字节码文件"}},[s._v("#")]),s._v(" 1.1 字节码文件")]),s._v(" "),e("p",[s._v('Java 字节码文件是 Java 程序编译后生成的中间代码，可以在 Java 虚拟机上跨平台运行。它实现了 Java 的 "一次编写，到处运行" 特性。')]),s._v(" "),e("h3",{attrs:{id:"字节码文件的结构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#字节码文件的结构"}},[s._v("#")]),s._v(" 字节码文件的结构")]),s._v(" "),e("div",{staticClass:"subtitle"},[e("p",[s._v("魔数与 class 文件的版本")])]),e("p",[s._v("每个 class 文件的头 4 个字节称为魔数，值为: 0XCAFEBABE，作用是确定这个文件是一个 class 文件。")]),s._v(" "),e("div",{staticClass:"subtitle"},[e("p",[s._v("常量池")])]),e("p",[s._v("常量池可以理解为 class 文件的资源仓库，是 class 文件结构中关联最多的数据类型，是占用 class 文件最大的数据项目之一。常量池存储的资源有：变量的属性、类型和名称，方法的属性、类型和名称等等。")]),s._v(" "),e("div",{staticClass:"subtitle"},[e("p",[s._v("访问标志")])]),e("p",[s._v("表示该 class 的属性和访问类型，比如该 class 是类还是接口、访问类型是否为 public、是否被标记为 final。")]),s._v(" "),e("div",{staticClass:"subtitle"},[e("p",[s._v("类索引、父类索引、接口索引")])]),e("p",[s._v("类索引、父类索引和接口索引可以简单的理解为一种描述的数据项目，class 文件根据类索引、父类索引和接口索引这三项数据来确定这个类的继承关系。")]),s._v(" "),e("div",{staticClass:"subtitle"},[e("p",[s._v("字段表属性")])]),e("p",[s._v("描述接口或类中声明的的变量。比如变量的作用域（public、private、 protected）、是否是静态变量（static） 、可变性（final） 、数据类型（基本类型、对象、数组）等等。")]),s._v(" "),e("div",{staticClass:"subtitle"},[e("p",[s._v("方法表属性")])]),e("p",[s._v("与字段表类似，不过方法表属性描述的是方法的类型、作用域等等。")]),s._v(" "),e("div",{staticClass:"subtitle"},[e("p",[s._v("属性表属性")])]),e("p",[s._v("描述某些场景专有的信息。比如字段表中特殊的属性、方法表中特殊的属性等等。")]),s._v(" "),e("h3",{attrs:{id:"从一个例子开始"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#从一个例子开始"}},[s._v("#")]),s._v(" 从一个例子开始")]),s._v(" "),e("p",[s._v("以一个简单的例子来逐步讲解字节码。")]),s._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Main.java")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Main")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" m"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("inc")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" m "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),e("p",[s._v("通过以下命令，可以在当前所在路径下生成一个 Main.class 文件。")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("javac Main.java\n")])])]),e("p",[s._v("以文本的形式打开生成的 class 文件，内容如下:")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cafe babe 0000 0034 0013 0a00 0400 0f09\n0003 0010 0700 1107 0012 0100 016d 0100\n0149 0100 063c 696e 6974 3e01 0003 2829\n5601 0004 436f 6465 0100 0f4c 696e 654e\n756d 6265 7254 6162 6c65 0100 0369 6e63\n0100 0328 2949 0100 0a53 6f75 7263 6546\n696c 6501 0009 4d61 696e 2e6a 6176 610c\n0007 0008 0c00 0500 0601 0010 636f 6d2f\n7268 7974 686d 372f 4d61 696e 0100 106a\n6176 612f 6c61 6e67 2f4f 626a 6563 7400\n2100 0300 0400 0000 0100 0200 0500 0600\n0000 0200 0100 0700 0800 0100 0900 0000\n1d00 0100 0100 0000 052a b700 01b1 0000\n0001 000a 0000 0006 0001 0000 0003 0001\n000b 000c 0001 0009 0000 001f 0002 0001\n0000 0007 2ab4 0002 0460 ac00 0000 0100\n0a00 0000 0600 0100 0000 0800 0100 0d00\n0000 0200 0e\n")])])]),e("p",[s._v("文件开头的 4 个字节（“cafe babe”）称之为 魔数，唯有以 “cafe babe” 开头的 class 文件方可被虚拟机所接受，这 4 个字节就是字节码文件的身份识别。")]),s._v(" "),e("p",[s._v("0000 是编译器 jdk 版本的次版本号 0，0034 是主版本号 52，java 的版本号从 45 开始，除 1.0 和 1.1 都是使用 45.x 外，以后每升一个大版本，版本号加 1。编译生成该 class 文件的 jdk 版本为 1.8.0。")]),s._v(" "),e("p",[s._v("通过分析 ClassFile 的内容，我们便可以知道 class 文件的组成：")]),s._v(" "),e("p",[e("img",{attrs:{src:t(722),alt:"image-20230127163654916"}})]),s._v(" "),e("h2",{attrs:{id:"_1-2-反编译字节码文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-反编译字节码文件"}},[s._v("#")]),s._v(" 1.2 反编译字节码文件")]),s._v(" "),e("p",[s._v("使用到 java 内置的反编译工具 javap 可以反编译字节码文件")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("javap "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("options"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("classes"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),e("p",[s._v("输入命令 "),e("code",[s._v("javap -verbose -p Main.class")]),s._v(" 查看输出内容：")]),s._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Classfile")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JavaCode")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TestProj")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("out"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("production"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TestProj")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("com"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rhythm7"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Main")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Last")]),s._v(" modified "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" size "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("362")]),s._v(" bytes\n  MD5 checksum "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("aed8540b098992663b7ba08c65312de\n  "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiled")]),s._v(" from "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Main.java"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[e("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rhythm7"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Main")]),s._v("\n  minor version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  major version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("52")]),s._v("\n  flags"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ACC_PUBLIC"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ACC_SUPER\n"),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Constant")]),s._v(" pool"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n   #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Methodref")]),s._v("          #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.")]),s._v("#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v("         "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// java/lang/Object."<init>":()V')]),s._v("\n   #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Fieldref")]),s._v("           #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.")]),s._v("#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v("         "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// com/rhythm7/Main.m:I")]),s._v("\n   #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Class")]),s._v("              #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("            "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// com/rhythm7/Main")]),s._v("\n   #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Class")]),s._v("              #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v("            "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// java/lang/Object")]),s._v("\n   #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               m\n   #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("I")]),s._v("\n   #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               "),e("span",{pre:!0,attrs:{class:"token generics"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("init"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n   #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("V")]),s._v("\n   #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Code")]),s._v("\n  #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LineNumberTable")]),s._v("\n  #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalVariableTable")]),s._v("\n  #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),s._v("\n  #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Lcom")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rhythm7"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Main")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               inc\n  #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("I")]),s._v("\n  #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SourceFile")]),s._v("\n  #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Main")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java\n  #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NameAndType")]),s._v("        #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("          "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// "<init>":()V')]),s._v("\n  #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NameAndType")]),s._v("        #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("          "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// m:I")]),s._v("\n  #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               com"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rhythm7"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Main")]),s._v("\n  #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               java"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lang"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" m"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    descriptor"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("I")]),s._v("\n    flags"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ACC_PRIVATE\n\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[e("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rhythm7"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Main")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    descriptor"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("V")]),s._v("\n    flags"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ACC_PUBLIC\n    "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Code")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n      stack"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" locals"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args_size"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" aload_0\n         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" invokespecial #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("                  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// Method java/lang/Object."<init>":()V')]),s._v("\n         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LineNumberTable")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        line "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalVariableTable")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Start")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Length")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Slot")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Name")]),s._v("   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Signature")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),s._v("   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Lcom")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rhythm7"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Main")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("inc")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    descriptor"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("I")]),s._v("\n    flags"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ACC_PUBLIC\n    "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Code")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n      stack"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" locals"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args_size"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" aload_0\n         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" getfield      #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("                  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Field m:I")]),s._v("\n         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" iconst_1\n         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" iadd\n         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ireturn\n      "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LineNumberTable")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        line "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalVariableTable")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Start")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Length")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Slot")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Name")]),s._v("   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Signature")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),s._v("   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Lcom")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rhythm7"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Main")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SourceFile")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Main.java"')]),s._v("\n")])])]),e("h3",{attrs:{id:"文件信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#文件信息"}},[s._v("#")]),s._v(" 文件信息")]),s._v(" "),e("p",[s._v("开头的 7 行信息包括：Class 文件当前所在位置、最后修改时间、文件大小、MD5 值、编译自哪个文件、类的全限定名、jdk 次版本号、主版本号。")]),s._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Classfile")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JavaCode")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TestProj")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("out"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("production"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TestProj")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("com"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rhythm7"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Main")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Last")]),s._v(" modified "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" size "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("362")]),s._v(" bytes\n  MD5 checksum "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("aed8540b098992663b7ba08c65312de\n  "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiled")]),s._v(" from "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Main.java"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[e("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rhythm7"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Main")]),s._v("\n  minor version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  major version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("52")]),s._v("\n")])])]),e("h3",{attrs:{id:"访问标志"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#访问标志"}},[s._v("#")]),s._v(" 访问标志")]),s._v(" "),e("p",[s._v("紧接着的是该类的访问标志：")]),s._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[s._v("  flags"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ACC_PUBLIC"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ACC_SUPER\n")])])]),e("p",[s._v("访问标志的含义如下：")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("标志名称")]),s._v(" "),e("th",[s._v("标志值")]),s._v(" "),e("th",[s._v("含义")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("ACC_PUBLIC")]),s._v(" "),e("td",[s._v("0x0001")]),s._v(" "),e("td",[s._v("是否为 Public 类型")])]),s._v(" "),e("tr",[e("td",[s._v("ACC_FINAL")]),s._v(" "),e("td",[s._v("0x0010")]),s._v(" "),e("td",[s._v("是否被声明为 final，只有类可以设置")])]),s._v(" "),e("tr",[e("td",[s._v("ACC_SUPER")]),s._v(" "),e("td",[s._v("0x0020")]),s._v(" "),e("td",[s._v("是否允许使用 invokespecial 字节码指令的新语义")])]),s._v(" "),e("tr",[e("td",[s._v("ACC_INTERFACE")]),s._v(" "),e("td",[s._v("0x0200")]),s._v(" "),e("td",[s._v("标志这是一个接口")])]),s._v(" "),e("tr",[e("td",[s._v("ACC_ABSTRACT")]),s._v(" "),e("td",[s._v("0x0400")]),s._v(" "),e("td",[s._v("是否为 abstract 类型，对于接口或者抽象类来说，此标志值为真")])]),s._v(" "),e("tr",[e("td",[s._v("ACC_SYNTHETIC")]),s._v(" "),e("td",[s._v("0x1000")]),s._v(" "),e("td",[s._v("标志这个类并非由用户代码产生")])]),s._v(" "),e("tr",[e("td",[s._v("ACC_ANNOTATION")]),s._v(" "),e("td",[s._v("0x2000")]),s._v(" "),e("td",[s._v("标志这是一个注解")])]),s._v(" "),e("tr",[e("td",[s._v("ACC_ENUM")]),s._v(" "),e("td",[s._v("0x4000")]),s._v(" "),e("td",[s._v("标志这是一个枚举")])])])]),s._v(" "),e("h3",{attrs:{id:"常量池"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#常量池"}},[s._v("#")]),s._v(" 常量池")]),s._v(" "),e("p",[s._v("常量池可以理解成 Class 文件中的资源仓库。主要存放的是两大类常量："),e("strong",[s._v("字面量（Literal）")]),s._v(" 和 "),e("strong",[s._v("符号引用（Symbolic References）")]),s._v("。字面量类似于 Java 中的常量概念，如文本字符串、final 常量等。符号引用则属于编译原理方面的概念，包括以下三种：")]),s._v(" "),e("ul",[e("li",[s._v("类和接口的全限定名")]),s._v(" "),e("li",[s._v("字段的名称和描述符")]),s._v(" "),e("li",[s._v("方法的名称和描述符")])]),s._v(" "),e("p",[s._v("不同于 C/C++，JVM 是在加载 Class 文件的时候才进行的动态链接，字段和方法符号引用只有在运行期转换后才能获得真正的内存入口地址。当虚拟机运行时，需要从常量池获得对应的符号引用，再在类创建或运行时解析并翻译到具体的内存地址中。")]),s._v(" "),e("p",[s._v("直接通过反编译文件来查看字节码内容：")]),s._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[s._v("#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" \t"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Methodref")]),s._v("          #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.")]),s._v("#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v("         "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// java/lang/Object."<init>":()V')]),s._v("\n#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" \t"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Class")]),s._v("              #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v("            "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// java/lang/Object")]),s._v("\n#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" \t"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               "),e("span",{pre:!0,attrs:{class:"token generics"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("init"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" \t"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("V")]),s._v("\n#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NameAndType")]),s._v("       #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("          \t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// "<init>":()V')]),s._v("\n#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("              java"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lang"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v("\n")])])]),e("p",[e("strong",[s._v("第一个常量")]),s._v(" 是一个方法定义，指向了第 4 和第 18 个常量。以此类推查看第 4 和第 18 个常量。最后可以拼接成第一个常量右侧的注释内容："),e("code",[s._v('java/lang/Object."<init>":()V')])]),s._v(" "),e("p",[s._v("这段可以理解为该类的实例构造器的声明，由于 Main 类没有重写构造方法，所以调用的是父类 Object 的构造方法。该方法默认返回值类型是 V，即是 void 类型。")]),s._v(" "),e("p",[e("strong",[s._v("第二个常量")]),s._v(" 同理可得：")]),s._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[s._v("#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" \t"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Fieldref")]),s._v("           #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.")]),s._v("#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v("         "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// com/rhythm7/Main.m:I")]),s._v("\n#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" \t"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Class")]),s._v("              #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("            "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// com/rhythm7/Main")]),s._v("\n#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" \t"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               m\n#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" \t"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("I")]),s._v("\n#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NameAndType")]),s._v("        #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("          "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// m:I")]),s._v("\n#"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Utf8")]),s._v("               com"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rhythm7"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Main")]),s._v("\n")])])]),e("p",[s._v("此处声明了一个字段 m，类型为 I，即 int 类型。关于字节码的类型对应如下：")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("标识字符")]),s._v(" "),e("th",[s._v("含义")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("B")]),s._v(" "),e("td",[s._v("基本类型 byte")])]),s._v(" "),e("tr",[e("td",[s._v("C")]),s._v(" "),e("td",[s._v("基本类型 char")])]),s._v(" "),e("tr",[e("td",[s._v("D")]),s._v(" "),e("td",[s._v("基本类型 double")])]),s._v(" "),e("tr",[e("td",[s._v("F")]),s._v(" "),e("td",[s._v("基本类型 float")])]),s._v(" "),e("tr",[e("td",[s._v("I")]),s._v(" "),e("td",[s._v("基本类型 int")])]),s._v(" "),e("tr",[e("td",[s._v("J")]),s._v(" "),e("td",[s._v("基本类型 long")])]),s._v(" "),e("tr",[e("td",[s._v("S")]),s._v(" "),e("td",[s._v("基本类型 short")])]),s._v(" "),e("tr",[e("td",[s._v("Z")]),s._v(" "),e("td",[s._v("基本类型 boolean")])]),s._v(" "),e("tr",[e("td",[s._v("V")]),s._v(" "),e("td",[s._v("特殊类型 void")])]),s._v(" "),e("tr",[e("td",[s._v("L")]),s._v(" "),e("td",[s._v("对象类型，以分号结尾，如 Ljava/lang/Object;")])])])]),s._v(" "),e("h3",{attrs:{id:"字段表和方法表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#字段表和方法表"}},[s._v("#")]),s._v(" 字段表和方法表")]),s._v(" "),e("p",[s._v("常量池之后的是对类内部的方法描述，在字节码中以表的集合形式表现。暂且不管字节码文件的 16 进制文件内容如何，我们直接看反编译后的内容。")]),s._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" m"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  descriptor"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("I")]),s._v("\n  flags"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ACC_PRIVATE\n")])])]),e("p",[s._v("此处声明了一个私有变量 m，类型为 int。")]),s._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[e("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rhythm7"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Main")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   descriptor"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("V")]),s._v("\n   flags"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ACC_PUBLIC\n   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Code")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n     stack"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" locals"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args_size"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" aload_0\n        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" invokespecial #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("                  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// Method java/lang/Object."<init>":()V')]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v("\n     "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LineNumberTable")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n       line "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n     "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalVariableTable")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n       "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Start")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Length")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Slot")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Name")]),s._v("   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Signature")]),s._v("\n           "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),s._v("   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Lcom")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rhythm7"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Main")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),e("p",[s._v("这里是构造方法：Main()，返回值为 void，公开方法。")]),s._v(" "),e("p",[s._v("Code 内的主要属性为：")]),s._v(" "),e("ul",[e("li",[s._v("stack：最大操作数栈，JVM 运行时会根据这个值来分配栈帧（Frame）中的操作栈深度，此处为1。")]),s._v(" "),e("li",[s._v("locals：局部变量所需的存储空间，单位为 Slot，Slot 是虚拟机为局部变量分配内存时所使用的最小单位，为 4 个字节大小。方法参数（包括实例方法中的隐藏参数 this）、显式异常处理器的参数（try catch 中的 catch 块所定义的异常）和方法体中定义的局部变量都需要使用局部变量表来存放。值得一提的是，locals 的大小并不一定等于所有局部变量所占的 Slot 之和，因为局部变量中的 Slot 是可以重用的。")]),s._v(" "),e("li",[s._v("args_size：方法参数的个数，这里是 1，因为每个实例方法都会有一个隐藏参数 this。")]),s._v(" "),e("li",[s._v('attribute_info：方法体内容，0、1、4 为字节码"行号"，该段代码的意思是将第一个引用类型本地变量推送至栈顶，然后执行该类型的实例方法，即常量池存放的第一个变量 '),e("code",[s._v('java/lang/Object."<init>":()V')]),s._v("，然后执行返回语句，结束方法。")]),s._v(" "),e("li",[s._v("LineNumberTable：该属性的作用是描述源码行号与字节码行号（字节码偏移量）之间的对应关系。可以使用 "),e("code",[s._v("-g:none")]),s._v(" 或 "),e("code",[s._v("-g:lines")]),s._v(" 选项来取消或要求生成这项信息，如果选择不生成 LineNumberTable，当程序运行异常时将无法获取到发生异常的源码行号，无法按照源码的行数来调试程序。")]),s._v(" "),e("li",[s._v("LocalVariableTable：该属性的作用是描述帧栈中局部变量与源码中定义的变量之间的关系。可以使用 "),e("code",[s._v("-g:none")]),s._v(" 或 "),e("code",[s._v("-g:vars")]),s._v(" 来取消或生成这项信息，如果没有生成这项信息，当别人引用这个方法时，将无法获取到参数名称，取而代之的是 arg0、arg1 这样的占位符。start 表示该局部变量在哪一行开始可见，length 表示可见行数，Slot 代表所在帧栈位置，Name 是变量名称，然后是类型签名。")])]),s._v(" "),e("p",[s._v("同理可以分析 Main 类中的另一个方法 inc()：将 this 入栈，获取字段 #2 并置于栈顶，将 int 类型的 1 入栈，将栈内顶部的两个数值相加，返回一个 int 类型的值。")]),s._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("inc")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   descriptor"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("I")]),s._v("\n   flags"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ACC_PUBLIC\n   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Code")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n     stack"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" locals"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args_size"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" aload_0\n        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" getfield      #"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("                  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Field m:I")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" iconst_1\n        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" iadd\n        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ireturn\n     "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LineNumberTable")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n       line "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n     "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalVariableTable")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n       "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Start")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Length")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Slot")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Name")]),s._v("   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Signature")]),s._v("\n           "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),s._v("   "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Lcom")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rhythm7"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Main")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])])}),[],!1,null,null,null);a.default=n.exports},722:function(s,a,t){s.exports=t.p+"assets/img/image-20230127163654916.4a3aecfc.png"}}]);